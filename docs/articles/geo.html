<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nccsdata">
<title>Geographic filtering with nccsdata â€¢ nccsdata</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Geographic filtering with nccsdata">
<meta property="og:description" content="nccsdata">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nccsdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_pull.html">Legacy Data Downloads With nccsdata</a>
    <a class="dropdown-item" href="../articles/geo.html">Geographic filtering with nccsdata</a>
    <a class="dropdown-item" href="../articles/ntee.html">Parsing NTEE Codes With nccsdata</a>
    <a class="dropdown-item" href="../articles/summary_stats.html">Summarising nccsdata</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/UrbanInstitute/nccsdata/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Geographic filtering with nccsdata</h1>
            
            <h4 data-toc-skip class="date">November 03 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UrbanInstitute/nccsdata/blob/HEAD/vignettes/geo.Rmd" class="external-link"><code>vignettes/geo.Rmd</code></a></small>
      <div class="d-none name"><code>geo.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette walks through the process of retrieving geographic
metadata used for filtering legacy NCCS files. The legacy data consists
of several relevant geographic variables:</p>
<ul>
<li>
<code>STATE</code>: 2 letter state abbreviation (all caps)</li>
<li>
<code>CITY</code>: Name of the city associated with the address
provided in <code>ADDRESS</code> (all caps)</li>
<li>
<code>FIPS</code>: <a href="https://transition.fcc.gov/oet/info/maps/census/fips/fips.txt" class="external-link">County
FIPS Codes</a>. Federal Information Processing System (FIPS) codes as
used by the US Census (5 digit integer)</li>
</ul>
<p>The last variable <code>FIPS</code> can be used to match observations
based on Census units. This preserves the external validity of
geographic units by operationalizing them according to U.S. Census
delineations.</p>
<p>In US Census data,<code>FIPS</code> are also tied to Core Based
Statistical Areas (CBSAs) that consist mutually exclusive Metropolitan,
(metros with populations above 50,000) and Micropolitan Statistical
Areas (populations above 10,000 and below 50,000). Further details and
examples are provided on the Census Crosswalks <a href="https://urbaninstitute.github.io/nccs/datasets/census/" class="external-link">page</a>
of the Urban NCCS Site. Thus, geographic filtering with US Census units
requires crosswalking units across multiple levels, such as county and
CBSA.</p>
<p>In this vignette, we will first explore these CBSA FIPS codes with
the <code><a href="../reference/geo_preview.html">geo_preview()</a></code> function before demonstrating how these
CBSA FIPS can be linked to county FIPS codes via
<code><a href="../reference/map_countyfips.html">map_countyfips()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UrbanInstitute/nccsdata" class="external-link">nccsdata</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploring-cbsa-fips-codes">Exploring CBSA FIPS codes<a class="anchor" aria-label="anchor" href="#exploring-cbsa-fips-codes"></a>
</h2>
<p>The <code><a href="../reference/geo_preview.html">geo_preview()</a></code> function allows users to preview and
retrieve CBSA FIPS codes and/or their associated metadata from a
specific state. In the following code snippet,
<code><a href="../reference/geo_preview.html">geo_preview()</a></code> returns the names of all CBSAs and their
associated FIPS codes. The <code>within</code> argument takes the
desired state, in abbreviated form, as input while the <code>geo</code>
argument returns the specified columns.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geo_preview.html">geo_preview</a></span><span class="op">(</span> geo<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cbsa"</span>,<span class="st">"cbsafips"</span><span class="op">)</span>, within<span class="op">=</span><span class="st">"FL"</span>, type<span class="op">=</span><span class="st">"metro"</span> <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |                                        cbsa| cbsafips|</span></span>
<span><span class="co">#&gt; |-------------------------------------------:|--------:|</span></span>
<span><span class="co">#&gt; |                             Gainesville, FL|    23540|</span></span>
<span><span class="co">#&gt; |                            Jacksonville, FL|    27260|</span></span>
<span><span class="co">#&gt; |           Panama City-Panama City Beach, FL|    37460|</span></span>
<span><span class="co">#&gt; |           Palm Bay-Melbourne-Titusville, FL|    37340|</span></span>
<span><span class="co">#&gt; |   Miami-Fort Lauderdale-West Palm Beach, FL|    33100|</span></span>
<span><span class="co">#&gt; |                             Punta Gorda, FL|    39460|</span></span>
<span><span class="co">#&gt; |                       Homosassa Springs, FL|    26140|</span></span>
<span><span class="co">#&gt; |                     Naples-Marco Island, FL|    34940|</span></span>
<span><span class="co">#&gt; |              Pensacola-Ferry Pass-Brent, FL|    37860|</span></span>
<span><span class="co">#&gt; |      Deltona-Daytona Beach-Ormond Beach, FL|    19660|</span></span>
<span><span class="co">#&gt; |                             Tallahassee, FL|    45220|</span></span>
<span><span class="co">#&gt; |         Tampa-St. Petersburg-Clearwater, FL|    45300|</span></span>
<span><span class="co">#&gt; |                                 Sebring, FL|    42700|</span></span>
<span><span class="co">#&gt; | Sebastian-Vero Beach-West Vero Corridor, FL|    42680|</span></span>
<span><span class="co">#&gt; |               Orlando-Kissimmee-Sanford, FL|    36740|</span></span>
<span><span class="co">#&gt; |                   Cape Coral-Fort Myers, FL|    15980|</span></span>
<span><span class="co">#&gt; |           North Port-Bradenton-Sarasota, FL|    35840|</span></span>
<span><span class="co">#&gt; |                                   Ocala, FL|    36100|</span></span>
<span><span class="co">#&gt; |                          Port St. Lucie, FL|    38940|</span></span>
<span><span class="co">#&gt; |      Crestview-Fort Walton Beach-Destin, FL|    18880|</span></span>
<span><span class="co">#&gt; |                   Lakeland-Winter Haven, FL|    29460|</span></span>
<span><span class="co">#&gt; |                   Wildwood-The Villages, FL|    48680|</span></span></code></pre></div>
<p>In the above code chunk, the function returns the names of all CBSAs
and their associated FIPS codes. <code>within</code> takes the desired
state as input while <code>geo</code> returns the specified columns.
<code>geo</code> can also be used to return county metadata.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geo_preview.html">geo_preview</a></span><span class="op">(</span>geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cbsa"</span>, <span class="st">"county"</span>, <span class="st">"cbsafips"</span><span class="op">)</span>, within <span class="op">=</span> <span class="st">"FL"</span>, type <span class="op">=</span> <span class="st">"metro"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |                                        cbsa|                           county| cbsafips|</span></span>
<span><span class="co">#&gt; |-------------------------------------------:|--------------------------------:|--------:|</span></span>
<span><span class="co">#&gt; |                             Gainesville, FL|      Alachua County, FL, Central|    23540|</span></span>
<span><span class="co">#&gt; |                            Jacksonville, FL|       Baker County, FL, Outlying|    27260|</span></span>
<span><span class="co">#&gt; |           Panama City-Panama City Beach, FL|          Bay County, FL, Central|    37460|</span></span>
<span><span class="co">#&gt; |           Palm Bay-Melbourne-Titusville, FL|      Brevard County, FL, Central|    37340|</span></span>
<span><span class="co">#&gt; |   Miami-Fort Lauderdale-West Palm Beach, FL|      Broward County, FL, Central|    33100|</span></span>
<span><span class="co">#&gt; |                             Punta Gorda, FL|    Charlotte County, FL, Central|    39460|</span></span>
<span><span class="co">#&gt; |                       Homosassa Springs, FL|       Citrus County, FL, Central|    26140|</span></span>
<span><span class="co">#&gt; |                            Jacksonville, FL|         Clay County, FL, Central|    27260|</span></span>
<span><span class="co">#&gt; |                     Naples-Marco Island, FL|      Collier County, FL, Central|    34940|</span></span>
<span><span class="co">#&gt; |                            Jacksonville, FL|        Duval County, FL, Central|    27260|</span></span>
<span><span class="co">#&gt; |              Pensacola-Ferry Pass-Brent, FL|     Escambia County, FL, Central|    37860|</span></span>
<span><span class="co">#&gt; |      Deltona-Daytona Beach-Ormond Beach, FL|      Flagler County, FL, Central|    19660|</span></span>
<span><span class="co">#&gt; |                             Tallahassee, FL|     Gadsden County, FL, Outlying|    45220|</span></span>
<span><span class="co">#&gt; |                             Gainesville, FL|   Gilchrist County, FL, Outlying|    23540|</span></span>
<span><span class="co">#&gt; |         Tampa-St. Petersburg-Clearwater, FL|    Hernando County, FL, Outlying|    45300|</span></span>
<span><span class="co">#&gt; |                                 Sebring, FL|    Highlands County, FL, Central|    42700|</span></span>
<span><span class="co">#&gt; |         Tampa-St. Petersburg-Clearwater, FL| Hillsborough County, FL, Central|    45300|</span></span>
<span><span class="co">#&gt; | Sebastian-Vero Beach-West Vero Corridor, FL| Indian River County, FL, Central|    42680|</span></span>
<span><span class="co">#&gt; |                             Tallahassee, FL|   Jefferson County, FL, Outlying|    45220|</span></span>
<span><span class="co">#&gt; |               Orlando-Kissimmee-Sanford, FL|        Lake County, FL, Outlying|    36740|</span></span>
<span><span class="co">#&gt; |                   Cape Coral-Fort Myers, FL|          Lee County, FL, Central|    15980|</span></span>
<span><span class="co">#&gt; |                             Tallahassee, FL|         Leon County, FL, Central|    45220|</span></span>
<span><span class="co">#&gt; |                             Gainesville, FL|        Levy County, FL, Outlying|    23540|</span></span>
<span><span class="co">#&gt; |           North Port-Bradenton-Sarasota, FL|      Manatee County, FL, Central|    35840|</span></span>
<span><span class="co">#&gt; |                                   Ocala, FL|       Marion County, FL, Central|    36100|</span></span>
<span><span class="co">#&gt; |                          Port St. Lucie, FL|       Martin County, FL, Central|    38940|</span></span>
<span><span class="co">#&gt; |   Miami-Fort Lauderdale-West Palm Beach, FL|   Miami-Dade County, FL, Central|    33100|</span></span>
<span><span class="co">#&gt; |                            Jacksonville, FL|      Nassau County, FL, Outlying|    27260|</span></span>
<span><span class="co">#&gt; |      Crestview-Fort Walton Beach-Destin, FL|     Okaloosa County, FL, Central|    18880|</span></span>
<span><span class="co">#&gt; |               Orlando-Kissimmee-Sanford, FL|       Orange County, FL, Central|    36740|</span></span>
<span><span class="co">#&gt; |               Orlando-Kissimmee-Sanford, FL|     Osceola County, FL, Outlying|    36740|</span></span>
<span><span class="co">#&gt; |   Miami-Fort Lauderdale-West Palm Beach, FL|   Palm Beach County, FL, Central|    33100|</span></span>
<span><span class="co">#&gt; |         Tampa-St. Petersburg-Clearwater, FL|        Pasco County, FL, Central|    45300|</span></span>
<span><span class="co">#&gt; |         Tampa-St. Petersburg-Clearwater, FL|     Pinellas County, FL, Central|    45300|</span></span>
<span><span class="co">#&gt; |                   Lakeland-Winter Haven, FL|         Polk County, FL, Central|    29460|</span></span>
<span><span class="co">#&gt; |                            Jacksonville, FL|    St. Johns County, FL, Central|    27260|</span></span>
<span><span class="co">#&gt; |                          Port St. Lucie, FL|    St. Lucie County, FL, Central|    38940|</span></span>
<span><span class="co">#&gt; |              Pensacola-Ferry Pass-Brent, FL|   Santa Rosa County, FL, Central|    37860|</span></span>
<span><span class="co">#&gt; |           North Port-Bradenton-Sarasota, FL|     Sarasota County, FL, Central|    35840|</span></span>
<span><span class="co">#&gt; |               Orlando-Kissimmee-Sanford, FL|     Seminole County, FL, Central|    36740|</span></span>
<span><span class="co">#&gt; |                   Wildwood-The Villages, FL|       Sumter County, FL, Central|    48680|</span></span>
<span><span class="co">#&gt; |      Deltona-Daytona Beach-Ormond Beach, FL|      Volusia County, FL, Central|    19660|</span></span>
<span><span class="co">#&gt; |                             Tallahassee, FL|     Wakulla County, FL, Outlying|    45220|</span></span>
<span><span class="co">#&gt; |      Crestview-Fort Walton Beach-Destin, FL|       Walton County, FL, Central|    18880|</span></span>
<span><span class="co">#&gt; |           Panama City-Panama City Beach, FL|  Washington County, FL, Outlying|    37460|</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="metropolitan-and-micropolitan-data">Metropolitan and Micropolitan Data<a class="anchor" aria-label="anchor" href="#metropolitan-and-micropolitan-data"></a>
</h2>
<p>Since CBSAs include a combination of <a href="https://www.census.gov/programs-surveys/metro-micro/about.html" class="external-link">metropolitan
or micropolitan statistical areas</a>, <code><a href="../reference/geo_preview.html">geo_preview()</a></code> allows
the user to select either unit using the <code>type</code> argument.</p>
<p>The below code snippet returns the CBSA names and FIPS codes for all
metropolitan statistical areas in Wyoming.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geo_preview.html">geo_preview</a></span><span class="op">(</span>geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cbsa"</span>,<span class="st">"cbsafips"</span><span class="op">)</span>, within <span class="op">=</span> <span class="st">"WY"</span>, type <span class="op">=</span> <span class="st">"micro"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |             cbsa| cbsafips|</span></span>
<span><span class="co">#&gt; |----------------:|--------:|</span></span>
<span><span class="co">#&gt; |      Laramie, WY|    29660|</span></span>
<span><span class="co">#&gt; |     Gillette, WY|    23940|</span></span>
<span><span class="co">#&gt; |     Riverton, WY|    40180|</span></span>
<span><span class="co">#&gt; |         Cody, WY|    17650|</span></span>
<span><span class="co">#&gt; |     Sheridan, WY|    43260|</span></span>
<span><span class="co">#&gt; | Rock Springs, WY|    40540|</span></span>
<span><span class="co">#&gt; |   Jackson, WY-ID|    27220|</span></span>
<span><span class="co">#&gt; |  Evanston, WY-UT|    21740|</span></span></code></pre></div>
<p>Setting <code>type</code> to <code>micro</code> returns data for
micropolitan statistical areas.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geo_preview.html">geo_preview</a></span><span class="op">(</span>geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cbsa"</span>,<span class="st">"cbsafips"</span><span class="op">)</span>, within <span class="op">=</span> <span class="st">"WY"</span>, type <span class="op">=</span> <span class="st">"metro"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |         cbsa| cbsafips|</span></span>
<span><span class="co">#&gt; |------------:|--------:|</span></span>
<span><span class="co">#&gt; | Cheyenne, WY|    16940|</span></span>
<span><span class="co">#&gt; |   Casper, WY|    16220|</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploring-csa-fips">Exploring CSA FIPS<a class="anchor" aria-label="anchor" href="#exploring-csa-fips"></a>
</h2>
<p>In addition to CBSAs, <code><a href="../reference/geo_preview.html">geo_preview()</a></code> can also retrieve
metadata for <a href="https://en.wikipedia.org/wiki/Combined_statistical_area" class="external-link">Combined
Statistical Areas</a> (CSAs).</p>
<p>CSAs (populations that form a coherent commercial and commuting zone)
are created by identifying adjacent micropolitant and metropolitan
statistical areas that constitute a coherent economic region.</p>
<p>The code snippet below returns all CSA names and FIPS codes for
metropolitan statistical areas in Virginia.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geo_preview.html">geo_preview</a></span><span class="op">(</span>geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cbsa"</span>, <span class="st">"cbsafips"</span>, <span class="st">"csa"</span>,<span class="st">"csafips"</span><span class="op">)</span>, </span>
<span>            within <span class="op">=</span> <span class="st">"VA"</span>, </span>
<span>            type <span class="op">=</span> <span class="st">"metro"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |                                         cbsa| cbsafips|                                            csa| csafips|</span></span>
<span><span class="co">#&gt; |--------------------------------------------:|--------:|----------------------------------------------:|-------:|</span></span>
<span><span class="co">#&gt; |                          Charlottesville, VA|    16820|                                               |      NA|</span></span>
<span><span class="co">#&gt; |                                 Richmond, VA|    40060|                                               |      NA|</span></span>
<span><span class="co">#&gt; |                                Lynchburg, VA|    31340|                                               |      NA|</span></span>
<span><span class="co">#&gt; | Washington-Arlington-Alexandria, DC-VA-MD-WV|    47900| Washington-Baltimore-Arlington, DC-MD-VA-WV-PA|     548|</span></span>
<span><span class="co">#&gt; |                   Staunton-Stuarts Draft, VA|    44420|        Harrisonburg-Staunton-Stuarts Draft, VA|     277|</span></span>
<span><span class="co">#&gt; |                                  Roanoke, VA|    40220|                                               |      NA|</span></span>
<span><span class="co">#&gt; |        Blacksburg-Christiansburg-Radford, VA|    13980|                                               |      NA|</span></span>
<span><span class="co">#&gt; |                            Winchester, VA-WV|    49020| Washington-Baltimore-Arlington, DC-MD-VA-WV-PA|     548|</span></span>
<span><span class="co">#&gt; |     Virginia Beach-Chesapeake-Norfolk, VA-NC|    47260|               Virginia Beach-Chesapeake, VA-NC|     545|</span></span>
<span><span class="co">#&gt; |                             Harrisonburg, VA|    25500|        Harrisonburg-Staunton-Stuarts Draft, VA|     277|</span></span>
<span><span class="co">#&gt; |                     Kingsport-Bristol, TN-VA|    28700|          Johnson City-Kingsport-Bristol, TN-VA|     304|</span></span></code></pre></div>
<p>Since CSAs are combination of various Micropolitan and Metropolitan
areas, not all CBSAs will fall under a CSA, and hence CSA FIPS are only
available for existing CSAs.</p>
</div>
<div class="section level2">
<h2 id="filtering-legacy-data-with-county-fips-codes">Filtering Legacy Data with County FIPS codes<a class="anchor" aria-label="anchor" href="#filtering-legacy-data-with-county-fips-codes"></a>
</h2>
<p>After retrieving the desired CBSA/CSA FIPS codes,
<code><a href="../reference/map_countyfips.html">map_countyfips()</a></code> can be used to match these with county
FIPS codes present in the legacy data, retrieved with
<code><a href="../reference/get_data.html">get_data()</a></code>. Downloaded data can then be filtered using
these county FIPS codes as shown below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrive CBSA FIPS from NY</span></span>
<span><span class="va">cbsa_ny</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geo_preview.html">geo_preview</a></span><span class="op">(</span>geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cbsa"</span>, <span class="st">"cbsafips"</span><span class="op">)</span>, </span>
<span>                       within <span class="op">=</span> <span class="st">"NY"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |                                  cbsa| cbsafips|</span></span>
<span><span class="co">#&gt; |-------------------------------------:|--------:|</span></span>
<span><span class="co">#&gt; |           Albany-Schenectady-Troy, NY|    10580|</span></span>
<span><span class="co">#&gt; |    New York-Newark-Jersey City, NY-NJ|    35620|</span></span>
<span><span class="co">#&gt; |                        Binghamton, NY|    13780|</span></span>
<span><span class="co">#&gt; |                             Olean, NY|    36460|</span></span>
<span><span class="co">#&gt; |                            Auburn, NY|    12180|</span></span>
<span><span class="co">#&gt; |                 Jamestown-Dunkirk, NY|    27460|</span></span>
<span><span class="co">#&gt; |                            Elmira, NY|    21300|</span></span>
<span><span class="co">#&gt; |                       Plattsburgh, NY|    38460|</span></span>
<span><span class="co">#&gt; |                            Hudson, NY|    26460|</span></span>
<span><span class="co">#&gt; |                          Cortland, NY|    18660|</span></span>
<span><span class="co">#&gt; | Kiryas Joel-Poughkeepsie-Newburgh, NY|    28880|</span></span>
<span><span class="co">#&gt; |               Buffalo-Cheektowaga, NY|    15380|</span></span>
<span><span class="co">#&gt; |                      Gloversville, NY|    24100|</span></span>
<span><span class="co">#&gt; |                           Batavia, NY|    12860|</span></span>
<span><span class="co">#&gt; |                        Utica-Rome, NY|    46540|</span></span>
<span><span class="co">#&gt; |               Watertown-Fort Drum, NY|    48060|</span></span>
<span><span class="co">#&gt; |                         Rochester, NY|    40380|</span></span>
<span><span class="co">#&gt; |                          Syracuse, NY|    45060|</span></span>
<span><span class="co">#&gt; |                         Amsterdam, NY|    11220|</span></span>
<span><span class="co">#&gt; |                           Oneonta, NY|    36580|</span></span>
<span><span class="co">#&gt; |                Massena-Ogdensburg, NY|    32390|</span></span>
<span><span class="co">#&gt; |                      Seneca Falls, NY|    42900|</span></span>
<span><span class="co">#&gt; |                           Corning, NY|    18500|</span></span>
<span><span class="co">#&gt; |                        Monticello, NY|    33910|</span></span>
<span><span class="co">#&gt; |                            Ithaca, NY|    27060|</span></span>
<span><span class="co">#&gt; |                          Kingston, NY|    28740|</span></span>
<span><span class="co">#&gt; |                       Glens Falls, NY|    24020|</span></span>
<span></span>
<span><span class="co"># Map these to county FIPS codes</span></span>
<span><span class="va">ny_countyfips</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_countyfips.html">map_countyfips</a></span><span class="op">(</span>geo.cbsafips <span class="op">=</span> <span class="va">cbsa_ny</span><span class="op">$</span><span class="va">cbsafips</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pull core data for the year 2015</span></span>
<span><span class="va">core_2015</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span>dsname <span class="op">=</span> <span class="st">"core"</span>,</span>
<span>                      time <span class="op">=</span> <span class="st">"2015"</span>,</span>
<span>                      scope.orgtype <span class="op">=</span> <span class="st">"NONPROFIT"</span>,</span>
<span>                      scope.formtype <span class="op">=</span> <span class="st">"PZ"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Valid inputs detected. Retrieving data.</span></span>
<span><span class="co">#&gt; Downloading core data</span></span>
<span><span class="co">#&gt; Requested files have a total size of 115 MB. Proceed</span></span>
<span><span class="co">#&gt;                       with download? Enter Y/N (Yes/no/cancel)</span></span>
<span><span class="co">#&gt; Core data downloaded</span></span>
<span></span>
<span><span class="co"># Filter with NY county FIPS</span></span>
<span><span class="va">core_2015_nyfips</span> <span class="op">&lt;-</span> <span class="va">core_2015</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">FIPS</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ny_countyfips</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
